#!/usr/bin/perl

sub revcomp {
  ($seq)=@_;
  $rev=reverse $seq;
  $rev=~tr/ABCDGHMNRSTUVWXYabcdghmnrstuvwxy/TVGHCDKNYSAABWXRtvghcdknysaabwxr/;
  return $rev;
}

while (<DATA>) {
  next unless /^(B.*)\s+([ACTG]+)$/;
  ($id, $seq)=($1,$2);
  $rev=revcomp($seq);
  $ID{$seq}="$id+";
  $ID{$rev}="$id-";
  $CNT{$seq}=0;
  $CNT{$rev}=0;
  #print "$seq +> $id+\n";
  #print "$rev -> $id-\n";
}

($sample)=@ARGV;

$N=0;
while (<STDIN>) { chomp(); $read=$_; $hit=0; $N++;
  foreach $seq (keys %ID) {
    $CNT{$seq}++ if $read=~/$seq/;
    $hit++;
  }
}

print "-\t$sample\t-\n";
print "READS\t$N\tTOTAL_READS\n";
foreach (keys %CNT) {
  print "$_\t$CNT{$_}\t$ID{$_}\n";
}

__END__

Internal Barcode
ID
dNuc TaqMan Reverse Primer
B058 Unmod. (me0) CGCGTAACGACGTACC
B017 H3K4me1 CGTTAACGCGTTTCGT
B079 H3K4me2 CGTACGTCGTGTCGAA
B038 H3K4me3 GTTCGCGACACCGTTC
B056 H3K9me1 TCGCGACGGACGTA
B092 H3K9me2 CGCATATCGCGTCGT
B005 H3K9me3 GAACGATTCGACGATCGT
B093 H3K27me1 TACGTGTCGCGCGTA
B032 H3K27me2 GAACGTTCGTCGACGAT
B008 H3K27me3 GAATCGTCGACGCGTATA
B022 H3K36me1 CGAAATTCGTATACGCGTCG
B034 H3K36me2 GTGATATCGCGTTAACGTCG
B077 H3K36me3 CGTAATGCGCGACGTTA
B033 H4K20me1 CGCGAACTATCGTCGATTC
B087 H4K20me2 CGATACGCCGATCGATC
B090 H4K20me3 CGATTCGACGGTCGC

Internal
Barcode ID
dNuc Barcode sequence
B058 Unmodified-A TTCGCGCGTAACGACGTACCGT
B097 Unmodified-B CGCGATACGACCGCGTTACGCG
B017 H3K4me1-A CGACGTTAACGCGTTTCGTACG
B096 H3K4me1-B CGCGACTATCGCGCGTAACGCG
B079 H3K4me2-A CCGTACGTCGTGTCGAACGACG
B019 H3K4me2-B CGATACGCGTTGGTACGCGTAA
B038 H3K4me3-A TAGTTCGCGACACCGTTCGTCG
B041 H3K4me3-B TCGACGCGTAAACGGTACGTCG
B056 H3K9me1-A TTATCGCGTCGCGACGGACGTA
B021 H3K9me1-B CGATCGTACGATAGCGTACCGA
B092 H3K9me2-A CGCATATCGCGTCGTACGACCG
B067 H3K9me2-B ACGTTCGACCGCGGTCGTACGA
B005 H3K9me3-A ACGATTCGACGATCGTCGACGA
B088 H3K9me3-B CGATAGTCGCGTCGCACGATCG
B093 H3K27me1-A CGCCGATTACGTGTCGCGCGTA
B070 H3K27me1-B ATCGTACCGCGCGTATCGGTCG
B032 H3K27me2-A CGTTCGAACGTTCGTCGACGAT
B044 H3K27me2-B TCGCGATTACGATGTCGCGCGA
B008 H3K27me3-A ACGCGAATCGTCGACGCGTATA
B025 H3K27me3-B CGCGATATCACTCGACGCGATA
B022 H3K36me1-A CGCGAAATTCGTATACGCGTCG
B100 H3K36me1-B CGCGATCGGTATCGGTACGCGC
B034 H3K36me2-A GTGATATCGCGTTAACGTCGCG
B039 H3K36me2-B TATCGCGCGAAACGACCGTTCG
B077 H3K36me3-A CCGCGCGTAATGCGCGACGTTA
B075 H3K36me3-B CCGCGATACGACTCGTTCGTCG
B033 H4K20me1-A GTCGCGAACTATCGTCGATTCG
B078 H4K20me1-B CCGCGCGTATAGTCCGAGCGTA
B087 H4K20me2-A CGATACGCCGATCGATCGTCGG
B076 H4K20me2-B CCGCGCGATAAGACGCGTAACG
B090 H4K20me3-A CGATTCGACGGTCGCGACCGTA
B061 H4K20me3-B TTTCGACGCGTCGATTCGGCGA
